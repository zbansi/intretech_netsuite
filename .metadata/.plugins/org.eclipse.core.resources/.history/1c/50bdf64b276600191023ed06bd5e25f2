package com.bansi.webservices.prototypes;

import com.netsuite.webservices.platform_2019_1.NetSuiteServiceLocator;

/**
 * Since 12.2 endpoint accounts are located in multiple data centers with different domain names.
 * To use the correct one, wrap the Locator and get the correct domain first.
 *
 * See getDataCenterUrls WSDL method documentation in the Help Center.
 */
private static class DataCenterAwareNetSuiteServiceLocator extends NetSuiteServiceLocator
{
   private String account;
 
   public DataCenterAwareNetSuiteServiceLocator(String account)
   {
      this.account = account;
   }
 
   @Override
   public NetSuitePortType getNetSuitePort(URL defaultWsDomainURL)
   {
      try
      {
         NetSuitePortType _port = super.getNetSuitePort(defaultWsDomainURL);
         // Get the webservices domain for your account
         DataCenterUrls urls = _port.getDataCenterUrls(account).getDataCenterUrls();
         String wsDomain = urls.getWebservicesDomain();
 
         // Return URL appropriate for the specific account
         return super.getNetSuitePort(new URL(wsDomain.concat(defaultWsDomainURL.getPath())));
      }
      catch (Exception e)
      {
         throw new RuntimeException(e);
      }
   }
}
